---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "oktapam_security_policy_v2 Resource - terraform-provider-oktapam"
subcategory: ""
description: |-
  A policy which defines how users can gain access to resources. For details, see Security policy https://help.okta.com/okta_help.htm?type=oie&id=ext-pam-policy.
---

# oktapam_security_policy_v2 (Resource)

A policy which defines how users can gain access to resources. For details, see [Security policy](https://help.okta.com/okta_help.htm?type=oie&id=ext-pam-policy).



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `active` (Boolean)
- `name` (String)
- `principals` (Attributes) (see [below for nested schema](#nestedatt--principals))
- `rules` (Attributes List) (see [below for nested schema](#nestedatt--rules))

### Optional

- `description` (String)
- `type` (String)

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedatt--principals"></a>
### Nested Schema for `principals`

Optional:

- `user_groups` (Attributes List) (see [below for nested schema](#nestedatt--principals--user_groups))

<a id="nestedatt--principals--user_groups"></a>
### Nested Schema for `principals.user_groups`

Required:

- `id` (String)

Optional:

- `name` (String)
- `type` (String)



<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Required:

- `name` (String)
- `privileges` (Attributes List) (see [below for nested schema](#nestedatt--rules--privileges))
- `resource_selector` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector))
- `resource_type` (String)

Optional:

- `conditions` (Attributes List) (see [below for nested schema](#nestedatt--rules--conditions))
- `override_checkout_duration_in_seconds` (Number)

<a id="nestedatt--rules--privileges"></a>
### Nested Schema for `rules.privileges`

Optional:

- `password_checkout_database` (Attributes) (see [below for nested schema](#nestedatt--rules--privileges--password_checkout_database))
- `password_checkout_ssh` (Attributes) (see [below for nested schema](#nestedatt--rules--privileges--password_checkout_ssh))
- `principal_account_ssh` (Attributes) (see [below for nested schema](#nestedatt--rules--privileges--principal_account_ssh))
- `reveal_password` (Attributes) (see [below for nested schema](#nestedatt--rules--privileges--reveal_password))

<a id="nestedatt--rules--privileges--password_checkout_database"></a>
### Nested Schema for `rules.privileges.password_checkout_database`

Required:

- `password_checkout_database` (Boolean)


<a id="nestedatt--rules--privileges--password_checkout_ssh"></a>
### Nested Schema for `rules.privileges.password_checkout_ssh`

Required:

- `password_checkout_ssh` (Boolean)


<a id="nestedatt--rules--privileges--principal_account_ssh"></a>
### Nested Schema for `rules.privileges.principal_account_ssh`

Required:

- `principal_account_ssh` (Boolean) Defines the privilege to make SSH connections to a server with the user's principal account.

Optional:

- `admin_level_permissions` (Boolean) Provides coarse grain (full admin) access to the user.
- `sudo_command_bundles` (List of String) UUIDs of the existing sudo command bundles. These commands have been created by the resource administrator
- `sudo_display_name` (String) The name for sudo commands that will be visible to end users


<a id="nestedatt--rules--privileges--reveal_password"></a>
### Nested Schema for `rules.privileges.reveal_password`

Required:

- `reveal_password` (Boolean)



<a id="nestedatt--rules--resource_selector"></a>
### Nested Schema for `rules.resource_selector`

Required:

- `server_based_resource` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource))

<a id="nestedatt--rules--resource_selector--server_based_resource"></a>
### Nested Schema for `rules.resource_selector.server_based_resource`

Required:

- `selectors` (Attributes List) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors))

<a id="nestedatt--rules--resource_selector--server_based_resource--selectors"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors`

Optional:

- `individual_server` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors--individual_server))
- `individual_server_account` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors--individual_server_account))
- `server_label` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors--server_label))

<a id="nestedatt--rules--resource_selector--server_based_resource--selectors--individual_server"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors.individual_server`

Required:

- `server` (String)


<a id="nestedatt--rules--resource_selector--server_based_resource--selectors--individual_server_account"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors.individual_server_account`

Required:

- `server` (String)
- `username` (String)


<a id="nestedatt--rules--resource_selector--server_based_resource--selectors--server_label"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors.server_label`

Required:

- `account_selector` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors--server_label--account_selector))
- `account_selector_type` (String)

Optional:

- `server_selector` (Attributes) (see [below for nested schema](#nestedatt--rules--resource_selector--server_based_resource--selectors--server_label--server_selector))

<a id="nestedatt--rules--resource_selector--server_based_resource--selectors--server_label--account_selector"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors.server_label.account_selector`

Optional:

- `usernames` (List of String)


<a id="nestedatt--rules--resource_selector--server_based_resource--selectors--server_label--server_selector"></a>
### Nested Schema for `rules.resource_selector.server_based_resource.selectors.server_label.server_selector`

Required:

- `labels` (Map of String)






<a id="nestedatt--rules--conditions"></a>
### Nested Schema for `rules.conditions`

Optional:

- `access_request` (Attributes) (see [below for nested schema](#nestedatt--rules--conditions--access_request))
- `gateway` (Attributes) (see [below for nested schema](#nestedatt--rules--conditions--gateway))
- `mfa` (Attributes) (see [below for nested schema](#nestedatt--rules--conditions--mfa))

<a id="nestedatt--rules--conditions--access_request"></a>
### Nested Schema for `rules.conditions.access_request`

Required:

- `request_type_name` (String)

Optional:

- `expires_after_seconds` (Number)
- `request_type_id` (String)


<a id="nestedatt--rules--conditions--gateway"></a>
### Nested Schema for `rules.conditions.gateway`

Required:

- `session_recording` (Boolean)
- `traffic_forwarding` (Boolean)


<a id="nestedatt--rules--conditions--mfa"></a>
### Nested Schema for `rules.conditions.mfa`

Required:

- `re_auth_frequency_in_seconds` (Number)

Optional:

- `acr_values` (String)
