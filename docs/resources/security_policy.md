---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "oktapam_security_policy Resource - terraform-provider-oktapam"
subcategory: ""
description: |-
  Limited Early Access Feature: A policy which defines how users can gain access to resources. For details, see Manage security policy https://help.okta.com/en/programs/opa-pam/Content/Topics/privileged-access/pam-policy.htm.
---

# oktapam_security_policy (Resource)

Limited Early Access Feature: A policy which defines how users can gain access to resources. For details, see [Manage security policy](https://help.okta.com/en/programs/opa-pam/Content/Topics/privileged-access/pam-policy.htm).



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `active` (Boolean) If true, indicates that the Security Policy is active.
- `name` (String) The human-readable name of the resource. Values are case-sensitive.
- `principals` (Block List, Min: 1, Max: 1) Defines the users bound to the Security Policy. (see [below for nested schema](#nestedblock--principals))
- `rule` (Block List, Min: 1, Max: 20) Defines the privileges available to resources matched to the Security Policy. (see [below for nested schema](#nestedblock--rule))

### Optional

- `description` (String) The human-readable description of the resource.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--principals"></a>
### Nested Schema for `principals`

Optional:

- `groups` (Set of String) The UUIDs of existing Groups.


<a id="nestedblock--rule"></a>
### Nested Schema for `rule`

Required:

- `name` (String) The human-readable name of the resource. Values are case-sensitive.
- `privileges` (Block List, Min: 1, Max: 1) The specific privileges granted to Principals on matching resources. (see [below for nested schema](#nestedblock--rule--privileges))
- `resources` (Block List, Min: 1, Max: 1) Defines the resources targeted by the Security Policy. (see [below for nested schema](#nestedblock--rule--resources))

Optional:

- `conditions` (Block List, Max: 1) The conditions required before a privilege is made available to the Principals. All conditions must be met. (see [below for nested schema](#nestedblock--rule--conditions))

<a id="nestedblock--rule--privileges"></a>
### Nested Schema for `rule.privileges`

Optional:

- `password_checkout_rdp` (Block List, Max: 1) Defines the privilege to make RDP connections to a server with a vaulted password. (see [below for nested schema](#nestedblock--rule--privileges--password_checkout_rdp))
- `password_checkout_ssh` (Block List, Max: 1) Defines the privilege to make SSH connections to a server with a vaulted password. (see [below for nested schema](#nestedblock--rule--privileges--password_checkout_ssh))
- `principal_account_rdp` (Block List, Max: 1) Defines the privilege to make RDP connections to a server with the user's principal account. (see [below for nested schema](#nestedblock--rule--privileges--principal_account_rdp))
- `principal_account_ssh` (Block List, Max: 1) Defines the privilege to make SSH connections to a server with the user's principal account. (see [below for nested schema](#nestedblock--rule--privileges--principal_account_ssh))

<a id="nestedblock--rule--privileges--password_checkout_rdp"></a>
### Nested Schema for `rule.privileges.password_checkout_rdp`

Required:

- `enabled` (Boolean) If `true`, grants the privilege to Principals on matching resources.


<a id="nestedblock--rule--privileges--password_checkout_ssh"></a>
### Nested Schema for `rule.privileges.password_checkout_ssh`

Required:

- `enabled` (Boolean) If `true`, grants the privilege to Principals on matching resources.


<a id="nestedblock--rule--privileges--principal_account_rdp"></a>
### Nested Schema for `rule.privileges.principal_account_rdp`

Required:

- `enabled` (Boolean) If `true`, grants the privilege to Principals on matching resources.
- `full_admin_access` (Boolean) Provides coarse grain (full admin) access to the user.


<a id="nestedblock--rule--privileges--principal_account_ssh"></a>
### Nested Schema for `rule.privileges.principal_account_ssh`

Required:

- `enabled` (Boolean) If `true`, grants the privilege to Principals on matching resources.
- `full_admin_access` (Boolean) Provides coarse grain (full admin) access to the user.



<a id="nestedblock--rule--resources"></a>
### Nested Schema for `rule.resources`

Required:

- `servers` (Block List, Min: 1, Max: 1) Defines the server-based resources targeted by the Security Policy. (see [below for nested schema](#nestedblock--rule--resources--servers))

<a id="nestedblock--rule--resources--servers"></a>
### Nested Schema for `rule.resources.servers`

Optional:

- `label_selectors` (Block List, Max: 1) Defines the label selectors used to target resources by the Security Policy. (see [below for nested schema](#nestedblock--rule--resources--servers--label_selectors))
- `server` (Block List) Defines a specific server targeted by the Security Policy. (see [below for nested schema](#nestedblock--rule--resources--servers--server))
- `server_account` (Block List) Defines a local server account targeted by the Security Policy. (see [below for nested schema](#nestedblock--rule--resources--servers--server_account))

<a id="nestedblock--rule--resources--servers--label_selectors"></a>
### Nested Schema for `rule.resources.servers.server_account`

Required:

- `server_labels` (Map of String) Defines a map of key-value pairs used to match servers.

Optional:

- `accounts` (List of String) The usernames of a local accounts on a server.


<a id="nestedblock--rule--resources--servers--server"></a>
### Nested Schema for `rule.resources.servers.server_account`

Required:

- `server_id` (String) The UUID of the server.


<a id="nestedblock--rule--resources--servers--server_account"></a>
### Nested Schema for `rule.resources.servers.server_account`

Required:

- `account` (String) The username of a local account on a server.
- `server_id` (String) The UUID of the server.




<a id="nestedblock--rule--conditions"></a>
### Nested Schema for `rule.conditions`

Optional:

- `access_request` (Block List) Identifies an existing Request Type in Access Requests. (see [below for nested schema](#nestedblock--rule--conditions--access_request))
- `gateway` (Block List, Max: 1) Configures traffic settings for an existing Gateway. (see [below for nested schema](#nestedblock--rule--conditions--gateway))

<a id="nestedblock--rule--conditions--access_request"></a>
### Nested Schema for `rule.conditions.access_request`

Required:

- `request_type_id` (String) The ID of the Access Request.
- `request_type_name` (String) The name of the Access Request.

Optional:

- `expires_after_seconds` (Number) The number of seconds the approval remains valid.


<a id="nestedblock--rule--conditions--gateway"></a>
### Nested Schema for `rule.conditions.gateway`

Required:

- `session_recording` (Boolean) Whether to record sessions made through a Gateway.
- `traffic_forwarding` (Boolean) Whether to forward traffic through a Gateway.


